/*
 * This file was generated by the Gradle 'init' task.
 */

buildscript {
    repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }

    dependencies {
        classpath "org.ajoberstar:grgit:1.7.2"
    }
}

plugins {
    // Apply the java-library plugin to add support for Java Library
    id 'com.github.johnrengelman.shadow' version '6.1.0'
    id 'java'
    id 'eclipse'
    id 'jacoco'
    id "org.ajoberstar.grgit" version "1.7.2"
}

configurations {
    provided
    compile.extendsFrom provided
}

repositories {
    mavenCentral()
    jcenter()
}

dependencies {
    shadow group: 'io.delta', name: 'delta-standalone_2.12', version: '0.4.1'
    // provided group: 'io.delta', name: 'delta-storage', version: '2.0.0rc1'

//    implementation group: 'org.apache.hadoop', name: 'hadoop-common', version: '3.1.0' // 3.2.0
//    implementation group: 'org.scala-lang', name: 'scala-library', version: '2.12.8' // 2.12.10
//    implementation group: 'org.apache.commons', name: 'commons-lang3', version: '3.4' // 3.7
//    implementation group: 'commons-logging', name: 'commons-logging', version: '1.1.3' // 1.1.3
//    implementation group: 'org.slf4j', name: 'slf4j-log4j12', version: '1.7.25' // ?
}

def connectorVersion = '1.0'
def companyName = 'Incorta.'

jar {
    manifest {
        attributes 'Manifest-Version': '1.0',
                    'Created-By': companyName,
                    'Implementation-Title': 'Incorta Deltalake',
                    'Implementation-Version': connectorVersion,
                    'Implementation-Vendor': companyName

        if (project.hasProperty('desc')) {
            attributes.put('Custom-Desc', desc)
        }
    }

    enabled = false
}

shadowJar {
    configurations = [project.configurations.shadow]
}

artifacts {
    archives shadowJar
}

// test and coverage
check {
    dependsOn jacocoTestReport
}

jacocoTestReport {
    dependsOn test
    reports {
        xml.enabled = true
    }
}
